<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Analog Clock (svg.js)</title>
  <style>
    body{
      margin:0;
      min-height:100vh;
      display:grid;
      place-items:center;
      background:#ececec;
      font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Noto Sans JP",sans-serif;
    }
    .wrap{
      display:grid;
      gap:10px;
      justify-items:center;
      padding:18px;
    }
    #mount{
      width:min(92vw, 420px);
      aspect-ratio:1/1;
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div id="mount" aria-label="アナログ時計"></div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/@svgdotjs/svg.js@3.2.4/dist/svg.min.js"></script>

  <script>
    /* ===== テーマ ===== */
    const theme = {
      frame:"#8a4f3a",
      dial:"#f7f7f5",
      text:"#101010",
      dotMinor:"rgba(0,0,0,0.35)",
      dotMajor:"#1a1a1a",
      hour:"#111",
      minute:"#111",
      second:"#9aa0a6"
    };

    const draw = SVG()
      .addTo("#mount")
      .viewbox(0,0,400,400)
      .size("100%","100%");

    const cx = 200, cy = 200;

    const polar = (deg, r) => {
      const a = deg * Math.PI / 180;
      return { x: cx + Math.sin(a) * r, y: cy - Math.cos(a) * r };
    };

    /* ===== フレーム ===== */
    draw.circle(400).center(cx,cy).fill(theme.frame);
    draw.circle(392).center(cx,cy).fill("none")
      .stroke({width:4, color:"rgba(255,255,255,.1)"});
    draw.circle(392).center(cx,cy).fill("none")
      .stroke({width:10, color:"rgba(0,0,0,.22)"}).opacity(.35);

    /* ===== 文字盤 ===== */
    const dialR = 172;
    draw.circle(dialR*2).center(cx,cy)
      .fill(theme.dial)
      .stroke({width:1, color:"rgba(0,0,0,.1)"});

    /* ===== 目盛り ===== */
    const ticks = draw.group();
    for(let i=0;i<60;i++){
      const p = polar(i*6, dialR*0.92);
      ticks.circle(i%5===0 ? 5 : 3)
        .center(p.x, p.y)
        .fill(i%5===0 ? theme.dotMajor : theme.dotMinor);
    }

    /* ===== 数字 ===== */
    const nums = draw.group();
    const numberRadius = dialR * 0.74;
    const fontSize = 42;
    const globalDy = -fontSize * 0.05;
    const tightK = 0.27;
    const dx = fontSize * tightK;

    function drawNumber(n, x, y){
      const yy = y + globalDy;

      if(n < 10){
        nums.text(String(n))
          .font({family:"Georgia,'Times New Roman',serif", size:fontSize, weight:700})
          .fill(theme.text)
          .attr({x, y:yy, "text-anchor":"middle", "dominant-baseline":"middle"});
        return;
      }

      const s = String(n);
      nums.text(s[0])
        .font({family:"Georgia,'Times New Roman',serif", size:fontSize, weight:700})
        .fill(theme.text)
        .attr({x:x-dx, y:yy, "text-anchor":"middle", "dominant-baseline":"middle"});
      nums.text(s[1])
        .font({family:"Georgia,'Times New Roman',serif", size:fontSize, weight:700})
        .fill(theme.text)
        .attr({x:x+dx, y:yy, "text-anchor":"middle", "dominant-baseline":"middle"});
    }

    for(let n=1;n<=12;n++){
      const p = polar((n%12)*30, numberRadius);
      drawNumber(n, p.x, p.y);
    }

    /* ===== 針 ===== */
    const hands = draw.group()
      .attr({style:"filter:drop-shadow(0 1px 1px rgba(0,0,0,.25))"});

    function makeHand(w, l, color, radius=0){
      return hands.rect(w, l)
        .move(cx - w/2, cy - l)
        .fill(color)
        .radius(radius);
    }

    const hHand = makeHand(12, 100, theme.hour, 2);
    const mHand = makeHand( 6, 145, theme.minute, 2);

    const sHand = hands.group();
    sHand.rect(2, 155).move(cx - 1, cy - 145).fill(theme.second);
    sHand.rect(4,  44).move(cx - 2, cy +   5).fill(theme.second);

    draw.circle(14).center(cx,cy)
      .fill("#cfcfcf")
      .stroke({width:1, color:"rgba(0,0,0,.25)"});

    /* ===== tick（1秒に1回） ===== */
    function tickAlignedOncePerSecond(){
      const d = new Date();
      const sec = d.getSeconds();
      const min = d.getMinutes() + sec/60;
      const hr  = (d.getHours()%12) + min/60;

      hHand.untransform().rotate(hr*30, cx, cy);
      mHand.untransform().rotate(min*6, cx, cy);
      sHand.untransform().rotate(sec*6, cx, cy);

      setTimeout(tickAlignedOncePerSecond, 1000 - d.getMilliseconds());
    }

    tickAlignedOncePerSecond();
  </script>
</body>
</html>
